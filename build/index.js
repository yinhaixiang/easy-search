$(function(){function e(){$.ajaxFileUpload({url:"upload",type:"post",secureuri:!1,fileElementId:"file",dataType:"json",success:function(e,t){e.success?(d=!0,$("#file").hide(),$(".file-name").html(e.file),$(".J_upload").html("已上传"),$(".delete").removeClass("hidden"),i=e.data):alert("上传文件失败！")},error:function(e,t,l){alert("上传文件失败！")}})}function t(){l=i[r-1].data;var e=l[0];if(l[s].length<=0)return s--,void alert("到底啦！恭喜你完成今天的任务了哟^_^");$(".current-item").html("");for(var t=0;t<e.length;t++)$(".current-item").append("<span><strong>"+e[t]+"</strong>"+l[s][t]+"</span>");var d=a+"&wd="+l[s][n-1];$(".J_link").attr("href",d).html(d),$("iframe").attr("src",d)}var l,r,n,i=[],s=1,a="http://www.baidu.com/s?ie=utf-8&f=8&rsv_bp=0&rsv_idx=1&tn=baidu&rsv_pq=d47c724e00056480&rsv_t=49bcozKs%2FmFi3dos5Az5qUUEbZKBDdleemItl4yol8HvG7bepEzSX%2BEEbeM&rsv_enter=1&rsv_sug3=5&rsv_sug1=3&rsv_sug7=100&rsv_sug2=0&inputT=10351&rsv_sug4=10409",d=!1;r=$(".sheet").val(),n=$(".col").val(),$(".J_upload").click(function(){return $("#file").val()?void e():void alert("请选择xlsx文件!")}),$(".prev").click(function(){s>1&&(s--,t())}),$(".next").click(function(){s<l.length-1&&(s++,t())}),$(".generate").click(function(){return d?(r=$(".sheet").val(),n=$(".col").val(),s=1,t(),void $(".hidden").removeClass("hidden")):void alert("请先上传xlsx文件！")}),$(".delete").click(function(e){e.preventDefault(),$("#file").show(),$(".file-name").html(""),$(".J_upload").html("上传xlsx"),$(".delete").addClass("hidden"),d=!1})});